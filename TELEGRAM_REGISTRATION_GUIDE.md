# üöÄ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Telegram

## ‚úÖ –ß—Ç–æ —Å–æ–∑–¥–∞–Ω–æ:

### **1. –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**
- üìç `src/lib/telegram-db.ts` - —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ localStorage
- üìä –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–µ—Å—Å–∏–∏, –∫–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- üîÑ –ü–æ–ª–Ω–∞—è CRUD –æ–ø–µ—Ä–∞—Ü–∏—è

### **2. Telegram Bot**
- üìç `supabase/functions/telegram-bot/index.ts`
- ü§ñ –ë–æ—Ç @asloguzbot —Å —Ç–æ–∫–µ–Ω–æ–º `8361698849:AAFl19mQYwVeUG3V0QghljXiKEz--7_Eyj8`
- üîê –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 5-–∑–Ω–∞—á–Ω—ã—Ö –∫–æ–¥–æ–≤
- ‚è∞ –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ 5 –º–∏–Ω—É—Ç
- üîÑ –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫

### **3. Frontend**
- üìç `src/lib/telegram-api.ts` - API –∫–ª–∏–µ–Ω—Ç
- üìç `src/pages/TelegramRegister.tsx` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- üé® –ö—Ä–∞—Å–∏–≤—ã–π UI —Å –≤—ã–±–æ—Ä–æ–º —Ä–æ–ª–∏

### **4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
- üîó –ö–Ω–æ–ø–∫–∞ "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram" –≤ Auth.tsx
- üì± –†–æ—É—Ç `/telegram-register`
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Firebase Auth

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### **–®–∞–≥ 1: –í—ã–±–æ—Ä —Ä–æ–ª–∏ –∏ –≤–≤–æ–¥ –Ω–æ–º–µ—Ä–∞**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –í—ã–±–∏—Ä–∞–µ—Ç –ö–ª–∏–µ–Ω—Ç/–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –í–≤–æ–¥–∏—Ç +998901234567
Backend ‚Üí –°–æ–∑–¥–∞–µ—Ç session_token
Backend ‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç telegram_link
```

### **–®–∞–≥ 2: Telegram –±–æ—Ç**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –û—Ç–∫—Ä—ã–≤–∞–µ—Ç t.me/asloguzbot?start=SESSION_TOKEN
–ë–æ—Ç ‚Üí –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
–ë–æ—Ç ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 5-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
–ë–æ—Ç ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

### **–®–∞–≥ 3: –í–≤–æ–¥ –∫–æ–¥–∞ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí –í–≤–æ–¥–∏—Ç –∫–æ–¥ –Ω–∞ —Å–∞–π—Ç–µ
Backend ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–¥
Backend ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
Frontend ‚Üí –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –¥–∞—à–±–æ—Ä–¥
```

## üì° API Endpoints:

### **POST /functions/v1/telegram-bot/session**
```json
{
  "phone": "+998901234567"
}
```
Response:
```json
{
  "success": true,
  "session_token": "uuid",
  "expires_at": "2026-01-02T12:05:00Z",
  "telegram_link": "https://t.me/asloguzbot?start=uuid"
}
```

### **POST /functions/v1/telegram-bot/verify**
```json
{
  "session_token": "uuid",
  "code": "12345"
}
```
Response:
```json
{
  "success": true,
  "telegram_id": 123456789,
  "user": {
    "id": "uuid",
    "telegram_id": 123456789,
    "phone": "+998901234567",
    "full_name": "User 123456789",
    "role": "client",
    "telegram_verified": true
  }
}
```

### **POST /functions/v1/telegram-bot/webhook**
Telegram webhook –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

### **–ö–æ–¥—ã:**
- ‚úÖ 5-–∑–Ω–∞—á–Ω—ã–µ –∫–æ–¥—ã (10000-99999)
- ‚úÖ –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ 5 –º–∏–Ω—É—Ç
- ‚úÖ –ú–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫
- ‚úÖ –û–¥–Ω–æ—Ä–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### **–°–µ—Å—Å–∏–∏:**
- ‚úÖ UUID —Ç–æ–∫–µ–Ω—ã
- ‚úÖ –°—Ä–æ–∫ –∂–∏–∑–Ω–∏ 5 –º–∏–Ω—É—Ç
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞
- ‚úÖ –ü—Ä–∏–≤—è–∑–∫–∞ –∫ —Ç–µ–ª–µ—Ñ–æ–Ω—É

### **–î–∞–Ω–Ω—ã–µ:**
- ‚úÖ –•—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –≤–Ω–µ—à–Ω–∏—Ö API

## üöÄ –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –¥–µ–ø–ª–æ—è:

### **1. ENV –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
```bash
TELEGRAM_BOT_TOKEN=8361698849:AAFl19mQYwVeUG3V0QghljXiKEz--7_Eyj8
```

### **2. –î–µ–ø–ª–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:**
```bash
supabase functions deploy telegram-bot
```

### **3. Webhook –¥–ª—è –±–æ—Ç–∞:**
```bash
curl.exe -X POST "https://api.telegram.org/bot8361698849:AAFl19mQYwVeUG3V0QghljXiKEz--7_Eyj8/setWebhook" \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://eqrzodfukdnwsogjzmoz.supabase.co/functions/v1/telegram-bot/webhook"
  }'
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:

### **1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –ø–æ—Ç–æ–∫:**
1. –û—Ç–∫—Ä—ã—Ç—å: http://localhost:8081/login
2. –ù–∞–∂–∞—Ç—å: "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ Telegram"
3. –í—ã–±—Ä–∞—Ç—å —Ä–æ–ª—å: –ö–ª–∏–µ–Ω—Ç/–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫
4. –í–≤–µ—Å—Ç–∏: +998901234567
5. –û—Ç–∫—Ä—ã—Ç—å Telegram —Å—Å—ã–ª–∫—É
6. –ü–æ–ª—É—á–∏—Ç—å 5-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥
7. –í–≤–µ—Å—Ç–∏ –∫–æ–¥ –Ω–∞ —Å–∞–π—Ç–µ
8. ‚úÖ –£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è!

### **2. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ localStorage
- –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –±–µ–∑ Supabase
- –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram API

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç:

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–ü–æ–ª–Ω–æ—Å—Ç—å—é –ª–æ–∫–∞–ª—å–Ω–æ** - –¥–∞–Ω–Ω—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ
- ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ** - 5-–∑–Ω–∞—á–Ω—ã–µ –∫–æ–¥—ã
- ‚úÖ **–ë—ã—Å—Ç—Ä–æ** - –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- ‚úÖ **–£–¥–æ–±–Ω–æ** - –≤—ã–±–æ—Ä —Ä–æ–ª–∏
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ** - —Å Firebase Auth

### **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- üì± –í—ã–±–æ—Ä —Ä–æ–ª–∏ (–ö–ª–∏–µ–Ω—Ç/–ü–µ—Ä–µ–≤–æ–∑—á–∏–∫)
- üîê 5-–∑–Ω–∞—á–Ω—ã–µ –∫–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- ‚è∞ 5 –º–∏–Ω—É—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
- üîÑ 5 –ø–æ–ø—ã—Ç–æ–∫ –≤–≤–æ–¥–∞
- üíæ –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ü§ñ –†–µ–∞–ª—å–Ω—ã–π Telegram –±–æ—Ç

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!** üéâ
